### 1.EDA
**Анализ данных:**
- Загружены данные: train (6999 записей) и test (1000 записей), 13 признаков
- Обнаружены пропуски (~200 записей в train)
- Найдено 985 полных дубликатов в train, 1799 объектов с одинаковым признаковым описанием
- После очистки: 5840 записей в train
- Для заполнения пропусков был выбран простой метод заполнения медианой

**Предобработка признаков:**
- Удалены единицы измерения из строковых признаков (kmpl, CC, bhp)
- Признак torque разделён на torque (Nm) и max_torque_rpm
- Пропуски заполнены медианами (рассчитанными по train)
- Типы данных приведены к корректным (engine, seats -> int)

**Визуализация:**
- Построены pairplot для train и test — распределения схожи (IID)
- Построены heatmap корреляций (Пирсон, Спирмен, PhiK)
- Проанализировано распределение целевой переменной (правосторонний скос)

### 2. Модели на числовых признаках

Обучены следующие модели:
| Модель | R^2 (train) | R^2 (test) |
|--------|------------|-----------|
| Linear Regression | 0.6003 | 0.5999 |
| Lasso (alpha=1.0) | 0.6003 | 0.5999 |
| Lasso (GridSearch, alpha=9000) | 0.5980 | 0.5879 |
| ElasticNet (GridSearch) | 0.5932 | 0.5724 |

**Выводы:**
- Модель недообучена (R^2 на train ~= R^2 на test), то есть ещё можно стремиться в повешение качества

- Наиболее информативный признак: max_power - что логично, с учетом любви людей к "мощным автомобилям"

### 3. Добавление категориальных признаков

**Feature Engineering из столбца name:**
- brand — марка автомобиля (первое слово)
- model — модель автомобиля (второе слово)
- name_len — длина названия в словах
- is_luxury — премиальный бренд (BMW, Audi, Mercedes и т.п)
- has_turbo — турбодизель (TDI, CRDI, TDCI)
- is_special_edition — специальная серия (Edition, Anniversary)
- has_plus_pro — расширенная комплектация (Plus, Pro, Premium, ZXI)
- is_base_trim — базовая комплектация (LXI, LDI, Base)
- is_old_bs — старый стандарт выбросов (BSII, BSIII)
- is_4wd — полный привод (4WD, AWD, Quattro)
- diesel_in_name — дизель в названии

**Результат Ridge с категориальными признаками:**
| Модель | R^2 (train) | R^2 (test) |
|--------|------------|-----------|
| Ridge (alpha=500) | 0.9006 | 0.9174 |

Категориальные признаки дали достаточно сильный буст по качеству, однако всё ещё модель не дообучена. Нужно делать блок feature-engineering )

### 4. Бизнес-метрики

| Модель | Доля в пределах 10% (test) | Средний штраф (test) |
|--------|---------------------------|---------------------|
| Linear Regression | 24.1% | 0.96 |
| Lasso (default) | 24.1% | 0.96 |
| Lasso (GridSearch) | 24.9% | 0.91 |
| ElasticNet (GridSearch) | 26.4% | 0.82 |
| Ridge (categorical) | 36.8% | 0.43 |

В целом ожидаемо, что в такой задаче модель с бОльшим числом признаков сильно вырвалась вперёд по качеству. Думаю, что это естественно
---

## Полученные результаты

### Итоговые метрики лучшей модели (Ridge с категориальными признаками):

| Метрика | Train | Test |
|---------|-------|------|
| R^2 | 0.9006 | 0.9174 |
| MSE | 2.85x10^10 | 4.75x10^10 |
| Доля прогнозов +-10% | 35.2% | 36.8% |
| Средний штраф (асимметричный) | 0.41 | 0.43 |

### Интерпретация:
- Модель объясняет **~92%** дисперсии цен на тестовой выборке
- Более трети прогнозов попадают в 10%-ный коридор от реальной цены
- R^2 на test выше, чем на train - это потому, что разнообразие автомобилей на test меньше. Это было видно в ноутбуке в самом на чале через df.describe

---

## Что дало наибольший прирост качества

### 1. Добавление категориальных признаков (+31.75% к R^2)
- Переход от R^2 = 0.60 к R^2 = 0.92
- Марка и модель автомобиля — ключевые признаки для предсказаний
- OHE-кодирование создало 248 новых признаков

### 2. Использование Ridge-регрессии
- L2-регуляризация справляется с мультиколлинеарностью OHE-признаков
- Оптимальный alpha=500 найден через GridSearchCV (10 фолдов)


## Что сделать не удалось и почему

### 1. L0-регуляризация
    В целом - я попробовал вариант из интернета, он дал плохие результаты, и у меня не хватило времени нормально поэкспериментировать и написать свой вариант.

### 2. Feature Engineering (бонусная часть)
- Я не успевал нормально подумать признаки

Какие были идеи:
- Мощность на литр объёма (max_power / engine)
- Dummy-столбец для пропусков
- Ещё больше признаков из name

## 3. Логарифмирование целевой переменной
    Я забыл, что нашел это)))

---

##Структура репозитория

```
├── AI_HW1_Regression_with_inference_pro.ipynb  # Основной ноутбук
├── app.py                                       # Streamlit приложение
├── model_pipeline.pkl                           # Обученная модель (scaler + Ridge)
├── ohe_encoder.pkl                              # OneHotEncoder
├── feature_info.pkl                             # Информация о признаках
├── train_data_for_eda.csv                       # Данные для EDA
├── requirements.txt                             # Зависимости
└── REPORT.md                                    # Этот файл
```

---


